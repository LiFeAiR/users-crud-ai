syntax = "proto3";
package grpc;
option go_package = "/grpc";
import "google/api/annotations.proto";

message Empty {

}

message Id {
  int32 id = 1;
}

message ListRequest {
  uint32 limit = 1;
  uint32 offset = 2;
}

message User {
  int32 id = 1;
  string name = 2;
  string email = 3;
  Organization organization = 4;
}
  
message Permission {
  int32 id = 1;
  string name = 2;
  string code = 3;
  string description = 4;
}
  
message PermissionCreateRequest {
  string name = 1;
  string code = 2;
  string description = 3;
}
  
message PermissionUpdateRequest {
  int32 id = 1;
  string name = 2;
  string code = 3;
  string description = 4;
}
  
message PermissionsResponse {
  repeated Permission data = 1;
}

message GetUserResponse {
  User user = 1;
  Organization organization = 2;
}

message UserCreateRequest {
  string name = 1;
  string email = 2;
  string password = 3;
  int32 organization_id = 4;
}

message UserUpdateRequest {
  int32 id = 1;
  string name = 2;
  string email = 3;
  string password = 4;
  int32 organization_id = 5;
}

message LoginRequest {
  string email = 1;
  string password = 2;
}

message LoginResponse {
  string token = 1;
  User user = 2;
}

message UsersResponse {
  repeated User data = 1;
}


message Organization {
  int32 id = 1;
  string name = 2;
}

message OrganizationCreateRequest {
  string name = 1;
}

message OrganizationUpdateRequest {
  int32 id = 1;
  string name = 2;
}

message OrganizationsResponse {
  repeated Organization data = 1;
}

service CrudService {
  rpc GetUsers (ListRequest) returns (UsersResponse) {
    option (google.api.http) = {
      get: "/api/users"
    };
  }
  rpc CreateUser (UserCreateRequest) returns (User) {
    option (google.api.http) = {
      post: "/api/users"
      body: "*"
    };
  }
  rpc GetUser (Id) returns (User) {
    option (google.api.http) = {
      get: "/api/user/{id}"
    };
  }
  rpc UpdateUser (UserUpdateRequest) returns (User) {
    option (google.api.http) = {
      put: "/api/user"
      body: "*"
    };
  }
  rpc DeleteUser (Id) returns (Empty) {
    option (google.api.http) = {
      delete: "/api/user/{id}"
    };
  }
  rpc Login (LoginRequest) returns (LoginResponse) {
    option (google.api.http) = {
      post: "/api/login"
      body: "*"
    };
  }
  rpc GetOrganizations (ListRequest) returns (OrganizationsResponse) {
    option (google.api.http) = {
      get: "/api/organizations"
    };
  }
  rpc CreateOrganization (OrganizationCreateRequest) returns (Organization) {
    option (google.api.http) = {
      post: "/api/organizations"
      body: "*"
    };
  }
  rpc GetOrganization (Id) returns (Organization) {
    option (google.api.http) = {
      get: "/api/organization/{id}"
    };
  }
  rpc UpdateOrganization (OrganizationUpdateRequest) returns (Organization) {
    option (google.api.http) = {
      put: "/api/organization"
      body: "*"
    };
  }
  rpc DeleteOrganization (Id) returns (Empty) {
    option (google.api.http) = {
      delete: "/api/organization/{id}"
    };
  }
  
  // Permission CRUD operations
  rpc CreatePermission (PermissionCreateRequest) returns (Permission) {
    option (google.api.http) = {
      post: "/api/permissions"
      body: "*"
    };
  }
  rpc GetPermission (Id) returns (Permission) {
    option (google.api.http) = {
      get: "/api/permission/{id}"
    };
  }
  rpc UpdatePermission (PermissionUpdateRequest) returns (Permission) {
    option (google.api.http) = {
      put: "/api/permission"
      body: "*"
    };
  }
  rpc DeletePermission (Id) returns (Empty) {
    option (google.api.http) = {
      delete: "/api/permission/{id}"
    };
  }
  rpc GetPermissions (ListRequest) returns (PermissionsResponse) {
    option (google.api.http) = {
      get: "/api/permissions"
    };
  }
}